---
title: "ggvega"
subtitle: "ggplot2 to Vega-Lite translator"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["default", "extra-theme.css"]
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
# library(tidyverse)
# install_github("hadley/emo")
# library(emo)
# emo_heart_eyes <- emo::ji("smiling face with heart-eyes")
```

### ggvega

Created to translate from ggplot2 to Vega-Lite  

- inspired by the capability `plotly::ggplotly()` provides 

.center[
<br/><br/><br/>
**(add visual of ggplot2 -> vl)**
]

.footnote[
This project has been supported by Iowa State University, Schneider Electric, and GSOC.
]

---
class: inverse, center, middle
# Motivation

---
### Goals

**ggplot2 + interactivity**

**build & deploy visual components** (in JS and HTML) 

- extensible to new data  

  - a guiding principle when making fundamental design choices

  - distinguishes this effort from `plotly::ggplotly()`

.center[
<br/><br/><br/>
**(example with update-able data??)**
]

???

---
### ggplot2 + interactivity

Our requirements for the JavaScript library:

  - has the grammar of graphics at its foundation  
  
  - is open source  
  
  - is easy to use  
  
  - is able to be linked with other preexisting htmlwidgets  
  
  - can be tied to ggplot2  

---
### Vega + Vega-Lite


Designed to be a visualization grammar that is built for analysis

Both Vega and Vega-lite use a JSON specification to create a visualization, with Vega-lite first compiling to
Vega and then rendered using Vega’s compiler.

An implementation of visualization terms with the
**grammar of graphics** at its core

---
.left-third2[
<!-- <img src="dsc_files/ggplot2.png" height="100"> -->

#### A layered Grammar

<!-- Four basic components that form a layer: -->

.salt[
#### data
]
.fat[
#### stat
]
.acid[
#### mapping
]
.heat[
#### geom
]
].left-third2[

#### Vega-Lite’s relation to ggplot2
<!-- <img src="dsc_files/vl2.png" height="100">

Four basic components that ... -->

.salt[
#### data
]
.fat[
#### transform
]
.acid[
#### encoding
]
.heat[
#### mark
]

].right-third2[

#### Grammar-of-Graphics as Food


<!-- <img src="dsc_files/ggfood2.png" height="100"> -->

<!-- Four basic factors that determine how good your food will taste: -->

.salt[
#### salt
]
.fat[
#### fat
]
.acid[
#### acid
]
.heat[
#### heat
]

]

---
### Motivating use-case for ggvega


A data-scientist designs a visualization using R with ggplot2  


---
### Motivating use-case for ggvega


A data-scientist designs a visualization using R with ggplot2  

<br/>

The ggplot2 object is translated to a Vega-Lite specification (using ggvega)  


---
### Motivating use-case for ggvega


A data-scientist designs a visualization using R with ggplot2  

<br/>

The ggplot2 object is translated to a Vega-Lite specification (using ggvega)  

<br/>

The Vega-Lite specification can be deployed to production, independently of the data used to design it. Vega provides the means to update Vega views with new data.


---
class: inverse, center, middle
# Design Philosophy

---
### Fundamental design choices


---
### Our approach


---
### ggplot -> ggspec




---
### ggspec -> vlspec




---
class: inverse, center, middle
# Examples

---
### ggvega



```{r message=FALSE, warning=FALSE}
library("ggplot2")
library("ggvega")
plot <- ggplot(iris) + 
  geom_point(aes(x = Petal.Width, y = Petal.Length, colour = Species))

as_vegaspec(plot)
```

???
vegawidget, an htmlwidget within the vegawidget GitHub organization, is used to render the specification created by ggvega. 

---
### ggvega + vlbuildr


```{r}
library("ggplot2")
library("ggvega")
library("vlbuildr")

plot <- ggplot(iris) + 
  geom_point(aes(x = Petal.Width, y = Petal.Length, colour = Species))

as_vegaspec(plot) %>%
vl_encode_fill("Species:N")
```

???
Once the Vega-Lite specification has been created, we can use vlbuildr, another package within the vegawidget GitHub organization, to modify the specification. vlbuildr is "a functional approach to building up specifications" and the package contains functions that can add various components to a specification.

---
### Add selections with vlbuildr!


???

With vlbuildr, we can add selections and conditional encodings without addressing this issue in ggvega/ggplot2.


---
class: inverse, center, middle
# Limitations

---
### Issues


---
### Mismatches


---
### Other limitations

---
class: inverse, center, middle
# Future Work

---
### Decisions, questions, etc.




---
### Roadmap
